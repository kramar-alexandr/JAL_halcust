procedure PrintResults(record RCVc RepSpec, record SchoolVc Sr, var integer cnt, var integer pupilcnt)begin  boolean testf;  testf = true;		if (nonblank(RepSpec.f1) and (Sr.Region != RepSpec.f1)) then begin	  testf = false;	end;  if (RepSpec.flags[1]==1 and Sr.Approved==1) then begin    testf = false;  end;  if (RepSpec.flags[1]==2 and Sr.Approved==0) then begin    testf = false;  end;	if testf then begin	  	  StartFormat(15);      Gray_Divider(0,1);      OutString(0,"SchoolDbl",Sr.SchoolCode,false);      OutString(2,0,Sr.Region,false);      OutString(3,0,Sr.SchoolName,false);      OutString(4,0,Sr.PupilCount,false);      OutString(5,0,Sr.Telephone,false);    Endformat;	  StartFormat(23);      OutString(3,0,Sr.Address,false);      OutString(5,0,Sr.Email,false);	  EndFormat;	  cnt = cnt + 1;	  pupilcnt = pupilcnt + Sr.PupilCount;  end; return;end;globalprocedure SchoolRn(record RCVc RepSpec)begin  record SchoolVc Sr;  boolean testf, loopback, res;  integer cnt, pupilcnt;  string 20 ckey, h2key;  string 100 head1, head2;  cnt = 0; pupilcnt=0;  loopback = false;  switch RepSpec.flags[0] begin    case 0: ckey = "SchoolName"; h2key = UsetStr(32283);     case 1: ckey = "SchoolCode"; h2key = UsetStr(32282);     case 2: ckey = "PupilCount"; h2key = UsetStr(32284); loopback = true;   end;    head1 = UsetStr(32281) & h2key;  if(nonblank(RepSpec.f1)) then begin    head2 = UsetStr(32280) & RepSpec.f1;  end;      StartReportJob(UsetStr(32320));    Header(1,head1,1);    if(nonblank(RepSpec.f1)) then begin      Header(2,head2,1);    end;  EndHeader;  SetRepCol(0,0);  SetRepCol(2,30);  SetRepCol(3,90);  SetRepCol(4,334);  SetRepCol(5,380);    StartFormat(15);    OutString(0,0,USetStr(12501),false);    OutString(2,0,USetStr(17603),false);    OutString(3,0,USetStr(12164),false);    //OutString(4,0,USetStr(10659),false);    OutString(4,0,USetStr(32268),false);    OutString(5,0,USetStr(2736),false);    //OutString(6,0,USetStr(12112),false);  EndFormat;  Startformat(4);    Black_Divider(0,1);  Endformat;  if (loopback==true) then begin    Sr.PupilCount = 20000;    while loopbackkey(ckey,Sr,1,true) begin      PrintResults(RepSpec, Sr, cnt, pupilcnt);    end;  end else begin    while loopkey(ckey,Sr,1,true) begin      PrintResults(RepSpec, Sr, cnt, pupilcnt);    end;  end;      Startformat(4);    Black_Divider(0,1);  Endformat;  StartFormat(15);    OutString(3,0,UsetStr(32263) & cnt & UsetStr(32269),false);    OutString(4,0,UsetStr(32263) & pupilcnt & UsetStr(32270),false);  EndFormat;  EndJob;  return;end;