function string 10 GetProductCode()begin  string 10 res;  integer code;  record WebNGTranslateVc WTr;    code = 1;  while res == "" begin    WTr.Code = code;	WTr.FileName = 3;	if readfirstmain(WTr,2,true)==false then begin 	  res = code;	end;	code = code + 1;  end;  GetProductCode = res;  return;end;globalfunction LongInt WebNGProductVcRecordCheck(var record WebNGProductVc WPr,record WebNGProductVc WP2r,LongInt stat,LongInt long4)begin  LongInt res;  string 5 tstr;  res = 0;  if (blank(WPr.Code)) then begin    RecordCheckError(1058,"",-1,"Code");          res = -1;    goto LWebNGProductVcRecordCheck;  end;  if WPr.Code <> WP2r.Code and nonblank(WP2r.Code) then begin    WPr.Code = WP2r.Code;    RecordCheckError(1056,"",-1,"Code");          res = -1;    goto LWebNGProductVcRecordCheck;  end;    //if (blank(WPr.Code)) then begin  //  RecordCheckError(1058,"",-1,"Code");        //  res = -1;  //  goto LWebNGProductVcRecordCheck;	//WPr.Code = GetProductCode;  //end else begin    tstr = "_" & CurrentCompany;	if right(WPr.Code,len(tstr)) <> tstr then begin	  WPr.Code = WPr.Code & "_" & CurrentCompany;	end;LWebNGProductVcRecordCheck:;  WebNGProductVcRecordCheck = res;  return;end;