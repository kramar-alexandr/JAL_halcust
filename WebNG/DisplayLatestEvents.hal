//external procedure WebOutStringFormatNL(string);external function string 255 FormatSimpleLink(string,boolean);external function string 255 GetLinkToStruct(LongInt,boolean);//external function Boolean FindMatchingContentTranslation(record WebNGContentVc,var record WebNGTranslateVc);external function boolean FindMatchingTranslation(string,var record WebNGTranslateVc,string);function string 255 FindEventRoot()begin  record WebNGStructVc WSr;  string 255 res;  boolean TrHs;  res = "";  WSr.Type = 55;  TrHs = true;  while loopKey("SerNr",WSr,1,TrHs) begin    if WSr.Type == 55 then begin      res = GetLinkToStruct(WSr.SerNr,true);      TrHs = false;    end;  end;  FindEventRoot = res;return;end;globalprocedure DisplayLatestEvents()begin  record JALClassBlock JCbl;  record WebNGContentVc WCr;  record WebNGContentStyleVc WCSr;  integer cnt;  boolean foundf,testf,TrHs;  string 255 linkstr,head;  string 255 root;  record JALEventVc JEr;  record WebNGTranslateVc WTr;    WebOutStringFormatNL("<ul>");  root = FindEventRoot;  JEr.ActiveFlag = 1;  JEr.StartDate = addYear(CurrentDate,-1);  TrHs = true;  while loopkey("Active",JEr,2,Trhs) begin    if JEr.ActiveFlag <> 1 or cnt>=3 then begin      TrHs = false;    end else begin      if FindMatchingTranslation(JEr.SerNr,WTr,JEr.DefLangCode) and JEr.ClosedFlag == 0 then begin          linkstr = FormatSimpleLink(root & JEr.SerNr,true);          WebOutStringFormatNL("<li>");          head = WTr.Comment;          if (len(head)>23) then begin            head = left(head,23) & "...";          end;          WebOutStringFormatNL("<a href=""" & linkstr & """>" & head & "</a>");          WebOutStringFormatNL("</li>");          cnt = cnt + 1;      end;    end;  end;  WebOutStringFormatNL("</ul>");   return;end;