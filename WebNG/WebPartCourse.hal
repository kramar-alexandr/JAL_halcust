external function string 255 toolwebngtranslatetext(integer);//external procedure WebOutStringFormatNL(string);external function string 255 FormatSimpleLink(string,boolean);external procedure ShowRedirectHtml(string,boolean);external updating procedure GenCourseMail(string,string,string);global webpublicupdating procedure WebPartCourse()begin  record CourseEventVc CEr,oldCEr;  row CourseEventVc CErw;  record CUVc CUr;  string 255 code,path;  integer rwcnt;  string 20 cust;  code = WebGetArg("cc");  path = WebGetArg("cpath");  cust = CurrentCust;  CEr.SerNr = code;  if cust <>"" then begin    if readfirstmain(CEr,1,true) then begin      RecordCopy(oldCEr,CEr);      rwcnt = MatRowCnt(CEr);            ClearRow(CEr,CErw,1);      CErw.ContactCode = cust;      CUr.Code = cust;      if readfirstmain(CUr,1,true) then begin        CErw.ContactName = CUr.Name;      end;      CErw.Price = CEr.Price;      CErw.CustCode = CErw.ContactCode;      MatRowPut(CEr,rwcnt,CErw);      if recordUpdate(oldCEr,CEr,false)==0 then begin         GenCourseMail(USetStr(32384) & CEr.CourseName,USetStr(32383),CUr.eMail);      end;    end;  end;  ShowRedirectHtml(FormatSimpleLink("/afterapply",true) & "?cc=" & CEr.SerNr & "&tpath=" & WebGetArg("cpath"),false);return;end;global webpublicupdating procedure WebDeleteFromCourse()begin    record CourseEventVc CEr;  record CourseEventVc oldCEr;  row CourseEventVc CErw;  integer rwcnt,i,j;  string 30 cust;  string 255 path;  cust = CurrentCust;        path = WebGetArg("cpath");      CEr.SerNr = WebGetArg("cc");	  if ReadFirstMain(CEr,1,true) then begin      recordCopy(oldCEr,CEr);      		  rwcnt = MatRowCnt(CEr);		for (i = 0; i < rwcnt ; i = i + 1) begin        MatRowGet(CEr,i,CErw);        if CErw.CustCode == cust then begin          MatRowDelete(CEr,i);          i = rwcnt;        end;		  end;      if RecordUpdate(oldCEr,CEr,false)==0 then begin end;  end;  ShowRedirectHtml(FormatSimpleLink("/afterremove",true) & "?cc=" & CEr.SerNr & "&tpath=" & WebGetArg("cpath"),false);return;end;global procedure ShowAfterApplyPage()begin  record CourseEventVc CEr;  CEr.SerNr = StringToLongInt(WebGetArg("cc"));  if readfirstmain (CEr,1, true) then begin     WebOutStringFormatNL(ToolWebNGTranslatetext(23060) & CEr.CourseName & " (" & CEr.TransDate & ")<br>");	WebOutStringFormatNL(ToolWebNGTranslateText(23061) & "<a href=""" & FormatSimpleLink(WebGetArg("tpath"),false) & """>" & ToolWebNGTranslateText(23062) & "</a>");  end;return;end;global procedure ShowAfterDeletePage()begin  record CourseEventVc CEr;  CEr.SerNr = StringToLongInt(WebGetArg("cc"));  if readfirstmain (CEr,1, true) then begin     WebOutStringFormatNL(ToolWebNGTranslatetext(23064) & CEr.CourseName & "<br>");	WebOutStringFormatNL(ToolWebNGTranslateText(23061) & "<a href=""" & FormatSimpleLink(WebGetArg("tpath"),false) & """>" & ToolWebNGTranslateText(23062) & "</a>");  end;return;end;